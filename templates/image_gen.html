<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>AI 图片生成 - 调色灵感专家</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}" />
  </head>
  <body>
    <div class="page">
      <header class="container header">
        <div class="header-row">
          <div class="title">
            <h1>AI 图片生成</h1>
          </div>
          {% if current_user %}
            <div class="header-actions">
              <span class="user-badge">你好，{{ current_user|e }}</span>
              <span class="user-badge">积分：{{ points_balance }}</span>
              <a class="link-button" href="{{ url_for('main.index') }}">返回调色</a>
              <a class="link-button" href="{{ url_for('main.points') }}">积分记录</a>
              <a class="link-button" href="{{ url_for('auth.logout') }}">退出</a>
            </div>
          {% endif %}
        </div>
        <p class="subtitle">输入提示词，AI 为您生成高质量创意图片</p>
      </header>

      <main class="container main">
        <section id="error-panel" class="alert hidden">
          <div class="alert-icon">!</div>
          <div>
            <h4>生成错误</h4>
            <p id="error-message"></p>
          </div>
        </section>

        <div class="grid">
          <div class="column">
            <section class="card">
              <div class="card-title">
                <span class="icon">✨</span>
                <h2>生成配置</h2>
              </div>
              
              <div class="field">
                <label for="prompt">提示词 (Prompt)</label>
                <textarea id="prompt" class="text-input" rows="5" placeholder="描述您想要生成的图像内容..."></textarea>
                <p class="field-hint">建议包含主体、环境、光影、风格等细节。</p>
              </div>

              <div class="field">
                <label for="size">图片比例</label>
                <select id="size" class="select-input">
                  <option value="1:1" selected>1:1 (正方形)</option>
                  <option value="3:2">3:2 (横向)</option>
                  <option value="2:3">2:3 (纵向)</option>
                  <option value="auto">自动</option>
                </select>
              </div>

              <div class="field">
                <label for="variants">生成数量</label>
                <select id="variants" class="select-input">
                  <option value="1" selected>1 张</option>
                  <option value="2">2 张 (消耗更多积分)</option>
                </select>
                <p class="field-hint">每增加一张图可能会额外消耗积分。</p>
              </div>

              <div class="field">
                 <label for="ref-urls">参考图链接 (可选)</label>
                 <textarea id="ref-urls" class="text-input" rows="3" placeholder="https://example.com/image1.jpg&#10;https://example.com/image2.jpg"></textarea>
                 <p class="field-hint">每行一个 URL，用于控制生成风格或构图。</p>
              </div>

              <button id="generate-button" class="primary-button" type="button">
                <span class="button-icon">🎨</span> 开始生成
              </button>

              <div id="status-panel" class="status hidden">
                <div class="spinner"></div>
                <p id="status-text">正在请求 AI...</p>
              </div>
            </section>
          </div>

          <div class="column wide">
            <div class="section-title">
              <div class="title-left">
                <span class="icon">🖼️</span>
                <h2>生成结果</h2>
              </div>
            </div>

            <div id="results" class="results empty-state">
              <div class="empty-card">
                <div class="empty-icon">🎨</div>
                <h3>等待生成</h3>
                <p>输入提示词并点击生成，结果将显示在这里。</p>
              </div>
            </div>
          </div>
        </div>
      </main>

      <footer class="container footer">
        <p>© 2026 调色灵感专家 | Powered by GRSAI</p>
      </footer>
    </div>

    <script src="{{ url_for('static', filename='image_gen.js') }}"></script>
  </body>
</html>
